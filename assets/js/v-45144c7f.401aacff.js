"use strict";(self.webpackChunkXray_docs_next=self.webpackChunkXray_docs_next||[]).push([[8064],{98571:(n,a,s)=>{s.r(a),s.d(a,{data:()=>e});const e={key:"v-45144c7f",path:"/en/config/api.html",title:"API Interface",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"ApiObject",slug:"apiobject",children:[]},{level:2,title:"Related Configuration",slug:"related-configuration",children:[]},{level:2,title:"Supported API List",slug:"supported-api-list",children:[{level:3,title:"HandlerService",slug:"handlerservice",children:[]},{level:3,title:"LoggerService",slug:"loggerservice",children:[]},{level:3,title:"StatsService",slug:"statsservice",children:[]},{level:3,title:"ReflectionService",slug:"reflectionservice",children:[]}]},{level:2,title:"API Calling Example",slug:"api-calling-example",children:[]}],filePathRelative:"en/config/api.md",git:{updatedTime:1678585494e3,contributors:[{name:"yuhan6665",email:"1588741+yuhan6665@users.noreply.github.com",commits:2},{name:"Winston2084",email:"126307318+Winston2084@users.noreply.github.com",commits:1},{name:"Zimo Li",email:"7163127+lzm0@users.noreply.github.com",commits:1},{name:"hmol233",email:"82594500+hmol233@users.noreply.github.com",commits:1}]}}},54975:(n,a,s)=>{s.r(a),s.d(a,{default:()=>x});var e=s(66252);const t=(0,e._)("h1",{id:"api-interface",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#api-interface","aria-hidden":"true"},"#"),(0,e.Uk)(" API Interface")],-1),o=(0,e.Uk)("API interface configuration provides a set of APIs based on "),p={href:"https://grpc.io/",target:"_blank",rel:"noopener noreferrer"},r=(0,e.Uk)("gRPC"),i=(0,e.Uk)(" for remote invocation."),l=(0,e.Uk)("The interface can be enabled through the api configuration module. When the api configuration is enabled, Xray will create an outbound proxy automatically. All incoming API connections need to be manually routed to this outbound proxy through "),c=(0,e.Uk)("routing rule configuration"),u=(0,e.Uk)("."),d=(0,e._)("p",null,[(0,e.Uk)("Please refer to the "),(0,e._)("a",{href:"#related-configuration"},"related configuration"),(0,e.Uk)(" in this section.")],-1),b={class:"custom-container warning"},h=(0,e.uE)('<p class="custom-container-title">WARNING</p><p>Most users do not need to use this API. Novices can ignore this item directly. :::</p><h2 id="apiobject" tabindex="-1"><a class="header-anchor" href="#apiobject" aria-hidden="true">#</a> ApiObject</h2><p><code>ApiObject</code> corresponds to the <code>api</code> item in the configuration file.</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;api&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;api&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;services&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;HandlerService&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;LoggerService&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;StatsService&quot;</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p><code>tag</code>: string</p></blockquote><p>Outbound proxy identifier.</p><blockquote><p><code>services</code>: [string]</p></blockquote><p>List of enabled APIs, optional values can be found in <a href="#supported-api-list">Supported API List</a>.</p><h2 id="related-configuration" tabindex="-1"><a class="header-anchor" href="#related-configuration" aria-hidden="true">#</a> Related Configuration</h2><p>An api inbound can be added to the inbounds configuration.</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;inbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n  <span class="token punctuation">{</span>\n    <span class="token property">&quot;listen&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token number">10085</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;protocol&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dokodemo-door&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span> <span class="token string">&quot;127.0.0.1&quot;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;api&quot;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">]</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Add routing rules for the api inbound in the routing configuration.</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;routing&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n  <span class="token property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span>\n      <span class="token property">&quot;inboundTag&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token string">&quot;api&quot;</span>\n      <span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token property">&quot;outboundTag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;api&quot;</span><span class="token punctuation">,</span>\n      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;field&quot;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="supported-api-list" tabindex="-1"><a class="header-anchor" href="#supported-api-list" aria-hidden="true">#</a> Supported API List</h2><h3 id="handlerservice" tabindex="-1"><a class="header-anchor" href="#handlerservice" aria-hidden="true">#</a> HandlerService</h3><p>APIs that modify the inbound and outbound proxies, with the following available functions:</p><ul><li>Add a new inbound proxy;</li><li>Add a new outbound proxy;</li><li>Delete an existing inbound proxy;</li><li>Delete an existing outbound proxy;</li><li>Add a user to an inbound proxy (VMess, VLESS, Trojan, and Shadowsocks(v1.3.0+) only);</li><li>Delete a user from an inbound proxy (VMess, VLESS, Trojan, and Shadowsocks(v1.3.0+) only);</li></ul><h3 id="loggerservice" tabindex="-1"><a class="header-anchor" href="#loggerservice" aria-hidden="true">#</a> LoggerService</h3><p>Supports restarting the built-in logger, which can be used in conjunction with logrotate to perform operations on log files.</p><h3 id="statsservice" tabindex="-1"><a class="header-anchor" href="#statsservice" aria-hidden="true">#</a> StatsService</h3>',21),m=(0,e.Uk)("Built-in data statistics service, see "),g=(0,e.Uk)("Statistics Information"),k=(0,e.Uk)(" for details."),f=(0,e.uE)('<h3 id="reflectionservice" tabindex="-1"><a class="header-anchor" href="#reflectionservice" aria-hidden="true">#</a> ReflectionService</h3><p>Supports gRPC clients to obtain the list of APIs from the server.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ grpcurl -plaintext localhost:10085 list\ngrpc.reflection.v1alpha.ServerReflection\nv2ray.core.app.proxyman.command.HandlerService\nv2ray.core.app.stats.command.StatsService\nxray.app.proxyman.command.HandlerService\nxray.app.stats.command.StatsService\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="api-calling-example" tabindex="-1"><a class="header-anchor" href="#api-calling-example" aria-hidden="true">#</a> API Calling Example</h2>',4),v={href:"https://github.com/XTLS/Xray-API-documents",target:"_blank",rel:"noopener noreferrer"},q=(0,e.Uk)("Xray-API-documents"),y=(0,e.Uk)(" @crossfw"),x={render:function(n,a){const s=(0,e.up)("OutboundLink"),x=(0,e.up)("RouterLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[t,(0,e._)("p",null,[o,(0,e._)("a",p,[r,(0,e.Wm)(s)]),i]),(0,e._)("p",null,[l,(0,e.Wm)(x,{to:"/en/config/routing.html"},{default:(0,e.w5)((()=>[c])),_:1}),u]),d,(0,e._)("div",b,[h,(0,e._)("p",null,[m,(0,e.Wm)(x,{to:"/en/config/stats.html"},{default:(0,e.w5)((()=>[g])),_:1}),k]),f,(0,e._)("p",null,[(0,e._)("a",v,[q,(0,e.Wm)(s)]),y])])],64)}}}}]);